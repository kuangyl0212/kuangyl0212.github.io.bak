---
layout: post
title:  "计算机网络之物理层"
date:   2018-06-29 19:34:42 +0800
categories:
    - "Computer-Networks"
image: assets/images/14.jpg
---

### 数据、信号与码元

数据是传送信息的实体。信号是数据的电气或电磁表现，是数据在传输过程中的存在形式。
码元是一个固定时长的信号波形，这个波形表示一位k进制数。这个固定时长内的信号称为k进制码元，这个时长称为码元的宽度。

信号可以是模拟的，也可以是数字的。连续变化的信号称为模拟信号，取值只有有限个离散值的信号称为数字信号。

数据的传输可以是串行传输，也可以是并行传输。串行传输是指一个比特一个比特按照时间顺序传输，并行传输是指多个比特通过多条信道同时传输。

### 信源、信宿和信道

信源是产生和发送数据的源头，信宿是接收数据的终点，信道是信号传输的媒介。信源发出的信息需要通过转换器转换成适合于在信道上传输的信号，而通过信道传输到接收端的信号需要先反变换成原始信息，再发给信宿。

一个信道可以视为一条线路的逻辑部件，一般用来表示向某个方向传送的信息的介质。一条通信线路往往包含一条发送信道和一条接收信道。

按照传输的信号的形式，信道可以分为模拟信道和数字信道；按传输介质可以分为有线信道和无线信道。

信道上传输的信号可以分为基带信号和宽带信号。基带信号是指用两种电压表示数字信号的0和1，然后送到数字信道上传输的信号，这种传输方式称为基带传输；宽带信号则是将信号调制成频分复用的模拟信号，然后传送到模拟信道上传输，这种传输方式称为宽带传输。

### 单工通信、半双工通信和全双工通信

1. 单工通信是指通信只在一个方向上发生，一方发送数据，另一方接收数据，而不能反过来，因此只需要一个信道，比如电视信号；
2. 半双工通信则是双方都可以发送和接收数据，但是任何一方都不能同时发送和接收，这时需要两条信道；
3. 全双工，双方可以同时发送和接收数据。

### 速率、波特和带宽

速率也称数据率，是指数据的传输速率，表示单位时间内传输的信息量，有码元速率和信息速率两种。

码元速率，顾名思义就是在单位时间内传输的码元的数量，单位是波特(Baud)，1波特表示1秒传输1个码元。码元速率与进制无关。

信息速率，又称比特率，表示在单位时间内传输的二进制码元的数量，单位是比特/秒(b/s)。

宽带原指信号的频带宽度，单位是赫兹(Hz)，但是在实际网络中，经常用带宽来表示通信线路所能传输数据的能力，即最高数据率，因此单位不再是赫兹，而是比特/秒。

### 调制与编码

为了传输，数据都需要变成信号，而信号又分为模拟信号和数字信号，于是将数据转换成模拟信号的过程称为调制，而将数据变为数字信号的过程则称为编码。

编码的规则有多种：
1. 非归零编码(NRZ)：用两个电压来表示两个二进制数字，如低电平表示0，高电平表示1。特点是容易实现，但无法检错；
2. 曼彻斯特编码(Manchester Encoding)：将一个码元分成两个相等的间隔，比如，前一个间隔为高电平后一个为低电平表示码元1，反过来表示码元0。每个码元中间出现跳变，这种跳变既作为时钟信号，又作为数据信号，缺点是占用频带带宽多出1倍。以太网使用的就是曼彻斯特编码。
3. 差分曼彻斯特编码：如果码元为1，则前半个码元在电平上与上一个码元的后半个码元一致，如果码元为0，则相反。特点是，每个码元中间都有一次电平跳转，可以实现自同步，且抗干扰性较好。
4. 4B/5B编码：将数据流每4位分为一组，按照4B/5B编码规则编为5位，5位可表示32中状态，其中的16个状态用来表示4位的数据，另外16种作为控制码。

引入曼彻斯特编码的目的是信号同步。
无论是非归零编码、归零编码亦或是反向不归零编码，在传输连续相同信号时，接收方无法识别接收到的信号是几个码元，因为没有一个码元的时长信息，因此还需要一个额外的信道来传送时钟信号(比如归零编码传送连续0或连续1、归零编码传送连续1，或是反向不归零编码(遇到"0"转换，遇到"1"不转换)传送连续1)。而曼彻斯特编码每一个码元中间都有一次跳变，因此就自带时钟信号，于是就可以实现自同步(比如规定前低后高为1，前高后低为2)。但是，也因此，一个二进制信号需要两个电平来表示，也就是说曼彻斯特编码的一个码元只能传输$\frac{1}{2}$bit信息，因此数据传输速率只有调制速率的1半。差分曼彻斯特编码也类似，所谓差分是指当前信号和前一个信号相同时为1，不同时为0，差分曼彻斯特编码具有更高的抗干扰性。

三种编码方式如图所示

![code]({{site.url}}/assets/images/code.jpg)

基本的调制方法有：
1. 幅移键控(ASK)：通过改变载波信号的振幅来表示0和1，容易实现但抗干扰能力差；
2. 频移键控(FSK)：改变频率来表示0和1，容易实现且抗干扰能力强，广泛使用；
3. 相移键控(PSK)：改变相位来表示0和1，又分为绝对调相和相对调相；
4. 正交振幅调制(QAM)：在频率相同的前提下，将ASK和PSK结合起来，形成叠加信号。

如图所示

![Modulation]({{site.url}}//assets/images/Modulation.png)

模拟信号编码为数字信号分为三个步骤：
1. 采样：对模拟信号进行周期性扫描，将模拟信号转换成时间上离散的信号；
2. 量化：将采样得到的电平幅值值按照一定的分级标度转化为对应的数字值并取整；
3. 将量化的结果转换成二进制编码。

### 电路交换、报文交换与分组交换

1. 电路交换
    
    在进行数据传输前，两个结点之间必须先建立一条专用(双方独占)的物理通信路径(由通信双方之间的交换设备和链路逐段连接而成)，该路径可能经过许多中间结点。该路径在整个数据传输过程中一直被独占，直到通信结束之后才被释放。因此电路交换分为三个阶段：连接建立、数据传输和连接释放。

2. 报文交换

    数据交换的单位是报文，报文携带目标地址、源地址等信息。报文在交换结点采用存储转发的传输方式。存储转发带来转发延时，不限制报文大小要求网络结点需要较大的缓存空间。

3. 分组交换

    分组交换也采用存储转发的方式。但是，分组交换限制了每次上传数据块的大小上限，把大的数据块划分成合理的小数据块，再加上一些控制消息信息构成分组(Packet)，网络结点根据控制信息把分组发送给下一结点，下一结点收到后，暂时保存在到等待队列，然后根据控制信息选择下一个结点，直到到达目的地。


三种交换方式如图所示

![packet-switching]({{site.url}}/assets/images/packet-switching.png)

### 数据报与虚电路

数据报和虚电路时分组交换的两种方式，数据报面向无连接，提供一种不可靠服务，不保证分组不丢失和按序到达以及多长时间到达，每个分组可以独立选择路径，所以某个节点发生故障时，后续分组就可以避开这个结点；虚电路是面向连接的，提供一种可靠服务，保证数据的可靠性和有序性，但是所有分组都通过同一路径传送，一旦某个结点出现故障，就需要重新建立一条虚电路。

分组交换根据通信子网向端点系统提供的服务，还可以进一步分为面向连接的虚电路方式和面向无连接的数据报方式。两种服务均由网络层提供。

以数据报的方式传输时，发送分组前不需要建立连接，尽最大努力交付，不同的分组可以走不同的路径，也可以按不同的顺序到达目的结点。当分组正在某一链路上传送时，分组并不占用网络的其他部分的资源。因为采用存储转发技术，资源是共享的，所以A主机发送分组的同时，B主机也可以向其他主机发送分组。

![datagram]({{site.url}}/assets/images/datagram.jpg)

虚电路方式则是试图把数据报方式和电路交换方式结合起来，分组发送之前需要双方建立一条逻辑上相连的虚电路，并且连接一旦建立，就固定了虚电路所对应的物理路径，也就是说分组走的是同一条物理路径。端系统每次建立虚电路时，选择一个未使用过的虚电路号分配给该虚电路，以区别于其他虚电路。数据分组除了分组号、校验和等控制信息以外还需要它要通过的虚电路号，以区别于其他虚电路上的分组。虚电路中每个节点需要维护一张虚电路表，每一项记录一个打开的虚电路。

虚电路之所以是虚的，是因为这条电路不是专用的，可能有多条虚电路通过同一结点，一个结点也可能同时和多个结点建立虚电路。每条虚电路支持特定的两个端系统之间的数据传输，两个端系统之间也可以建立多条虚电路为不同的进程服务，这些虚电路实际的路由也可能不一样。

![virtual]({{site.url}}/assets/images/virtual.jpg)


### 传输介质

#### 1. 双绞线
也就是我们通常所说的网线。绞合的目的是减少相邻导线的电磁干扰。如果要进一步提高抗电磁干扰能力，可以在在双绞线的外面再加一层金属丝编织成的屏蔽层，有屏蔽层的双绞线被称为屏蔽双绞线(STP)，没有屏蔽层的普通双绞线成为(UTP)。双绞线是最常用的传输介质之一在局域网和电话网中普遍使用。下图是UTP：

![UTP_cable.jpg]({{site.url}}/assets/images/UTP_cable.jpg)

#### 2. 同轴电缆

同轴电缆由铜质内导体、绝缘层、网状编制屏蔽层和塑料外层构成。通常分为两类，50$\Omega$和75$\Omega$，50$\Omega$同轴电缆主要用于传输基带信号，因此又被称为基带同种电缆，局域网中广泛应用；75$\Omega$同轴电缆主要用于传输宽带信号，又称为宽带同轴电缆，主要用于有线电视系统。

![coaxial]({{site.url}}/assets/images/coaxial.jpg)

#### 3. 光纤

利用光导纤维传输光脉冲来通信。有光脉冲表示1，无光脉冲表示0。光纤主要由纤芯和包层构成，光波通过纤芯传导，包层则具有较低的折射率，当光线从高折射率的纤芯射向低折射率的包层时，折射角角将大于入射角，入射角足够大时，将发生全反射，也就是说，光纤碰到包层就会折射回纤芯、不断往复这个过程，光线就一直向下传播。
只要入射角大于某个临界值就会发生全反射，这样就可以有多条不同入射角的光纤在同一条光纤中传输，这种光纤称为多模光纤。多模光纤光源为发光二极管，传输过程中会逐渐展宽，造成失真，因此多模光纤只适合与近距离传输。
如果光纤的直径足够小，仅能容纳一个光的波长，则光纤就像一根波导，使光线一直传播，而不会产生多次反射，这种光纤称为单模光纤。

![fibre-optical.jpg]({{site.url}}/assets/images/fibre-optical.jpg)

#### 4. 无线介质
1. 无线电波
2. 微波、红外线和激光

### 物理层接口的特性

1. 机械特性：主要定义物理连接的边界点，即接插装置。规定物理连接时所采用的规格、引线的数目、引脚的数量和排列情况等。
2. 电气特性：规定传输二进制为时，线路上信号的电压高低、阻抗匹配、传输速度和距离限制等。
3. 功能特性：指明某条线上的某一电平表示何种意义，接口部件的信号线的用途(数据线、控制线、定时线等)。
4. 规程特性。主要定义各条物理线路的工作规程和时序关系。

### 物理层设备

#### 1. 中继器

中继器又称转发器，主要功能是将信号整形并放大再转发出去，以消除信号由于经过一长段电缆因噪声或其他原因而造成的失真和衰减，使信号的波形和强度达到所需的要求，来扩大网络传输的距离。原理是信号再生，仅作用于信号的电气部分，而不管数据中的数据是否正确。除了扩大传输距离外，中继器还可以完成不同的媒体的转接。由于中继器工作再物理层(没有存储转发功能)，因此不能连接两个速率不同的局域网。中继器有输入和输出两个端口，两端是网段而不是子网，中继器故障两端都会受影响。
中继器和放大器都可以放大信号，但是放大器放大的是模拟信号，原理是衰减信号放大，中继器放大的则是数字信号，原理是衰减信号整形再生。

#### 2. 集线器

集线器是一个多端口的中继器，也工作在物理层。接收到信号后，经过整形再生然后转发给出收到信号的端口以外的所有端口。如果两个或两个以上端口同时输入，那么输出时会产生冲突。集线器不能分割冲突与，所有集线器端口都属于同一个冲突域。

